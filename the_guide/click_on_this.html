<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>

body {
  font-family: Arial;
  margin: 0;
  background-color: #E6E5E0;
}
#logo {
  height: 70px;
}

h2, h3 {
  font-size: 2vw;
  margin-bottom: 0;
}

#tabs {
  background-color: white;
  width: 90%;
  margin: auto;
  margin-bottom: 75px;
}

h1, h2, h3 {
  color: #006eb6;
}

#center-square {
  width: 20%;
}

#title {
    margin-left: 10px;
    width: 90%;
    margin: auto;
}

/* Style the tab */
.tab {
  overflow: hidden;
  background-color: #E6E5E0;
}

/* Style the buttons inside the tab */
.tab button {
  height: 70px;
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
  color: #006eb6;
}

/* Change background color of buttons on hover */
.tab button:hover {
   color: black;
}

/* Create an active/current tablink class */
.tab button.active {
  background-color: white;
  color: black;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border-top: none;
}

#blue_column {
  height: 70px;
  background-color: #006eb6;
  margin: 0;
}

#folder_img1 {
  width: 50%;
}

#folder_img2 {
  width: 45%;
}

#folder_img3 {
  width: 33%;
}

#folder_img4 {
  width: 26%;
}

#code_img1 {
  width: 30%;
}

</style>
</head>
<body>

<div id="blue_column">
  <img src="images/logo.png" alt="BYUI Logo" id="logo">
</div>


<div id="title">
  <h1>Housing Survey Reports</h1>
<p>Click on the buttons inside the tabbed menu:</p>
</div>


<div id="tabs">

  <div class="tab">
    <button class="tablinks" onclick="openCity(event, 'drive')">Housing Drive</button>
    <button class="tablinks" onclick="openCity(event, 'folders')">Folders</button>
    <button class="tablinks" onclick="openCity(event, 'data')">Data</button>
    <button class="tablinks" onclick="openCity(event, 'vs')">VS Code</button>
    <button class="tablinks" onclick="openCity(event, 'python')">Python</button>
    <button class="tablinks" onclick="openCity(event, 'code')">The Code</button>
    <button class="tablinks" onclick="openCity(event, 'reports')">Reports</button>
    <button class="tablinks" onclick="openCity(event, 'errors')">Errors</button>
  </div>
  
  <div id="drive" class="tabcontent">
    <h2>Getting access to the idrive</h2>
    <p>You’ll need access to the idrive to get to the reports code folder. This is how to get there:</p>
    <p>1. Talk to someone in the office to make sure you have already been granted access to it.</p>
    <p>2.	Go to File Explorer and click on “This PC” on the side bar.</p>
    <img src="images/housing_drive_1.png" alt="idrive instructions">
    <p>3.	Then click on the “Computer” tab at the top left, and then click on the “Map network drive” icon.</p>
    <img src="images/housing_drive_2.png" alt="idrive instructions">
    <p>4.	After the window pulls up, type \\idrive\housing (NOTE: make sure they are back slashes ‘\’ and NOT forward slashes ‘/’) in the “Folder” input field.</p>
    <p>5.	Make sure “Reconnect at sign-in” is checked and then click “Finish”.</p>
    <img src="images/housing_drive_3.png" alt="idrive instructions">
    <p>6.	Go to "Employees" > "Troy" > "Housing Survey Program".</p>
  </div>
  
  <div id="folders" class="tabcontent">
      <h2>Organazing the folders</h2>
      <p>Before the program is able to generate the reports, we need to make sure the folders are organized and named in the exact way the program is expecting them to.  Here is what each folder is supposed to have.<br><br></p>

      <h3>Main folder</h3>
      <p>The four things that you are supposed to see after clicking on "Housing Survey Program" are: the "main.py" file, the "reports_functions.py" file, the "data" folder, and the "reports" folder. Usually, there is also going to be a "pycache" folder, but you don't have to worry about that since it is automatically generated by python. If it's not there, python will make a new one by itself after you run the code.</p>
      <img id="folder_img1" src="images/folders_1.png" alt="folder_screenshot">

      <h3>Data folder</h3>
      <p>The two types of files that need to be in the "data" folder are the "complex_names.csv" file and "housing_survey_data.csv" files for that year (wi, sp, fa).</p>
      <img id="folder_img2" src="images/folders_2.png" alt="folder_screenshot">

      <h3>Reports folder</h3>
      <p>One thing you need to be aware of is that the program is case and space sensitive. So, make sure that the name of each subfolder is in lower case, and in the case of the folders with more than one word, make sure they have an underscore ("_") separating the two words instead of a space.</p>
      <p>The first subfolder you need to have in "reports" is one with the year we are on (2024, 2025..). In that folder the four subfolders you need to have are: "all_ratings", "winter", "spring", and "fall".</p>
      <img id="folder_img3" src="images/folders_4.png" alt="folder_screenshot">
      <p>The semester reports don't have any subolders, but the "all_ratings" one does.  The "all ratings" folders needs to have the following subfolders: "winter_ratings", "spring_ratings", and "fall_ratings".</p>
      <img id="folder_img4" src="images/folders_5.png" alt="folder_screenshot">

  </div>
  
  <div id="data" class="tabcontent">
    <h3>Adding new apartment complexes</h3>
    <p>Sometimes to test the survey before sending it out to everyone, the department who does it will answer the survey themselves and use non-existent apartment names. Once they send you all the reponses for that semester, the test survey responses will also be in that file. The "complex_names.csv" file is used by the program to double check if the complex name in the responses actually exists. If there's ever a new complex you would need to update the "complex_names" file by adding the name of the apartment complex and who owns it. Because if the name of the new complex doesn't match exactly with one of the names in the file, it will think those responses were from someone testing the survey, and it won't generate a report for it. Just make sure to not change the name or the type of the file when you add (or remove) a complex from the list.<br><br></p> 

    <h2>Converting the the raw data file to csv</h2>
    <p>1.	Download “Approved Housing” excel file that Brother Dougherty sends you.</p> 
    <p>2.	Change to a CSV format in Excel</p> 
    <p>3. Rename the file using this format: “housing_survey_data_<semester-year code>” (i.e. housing_survey_data_wi23 | “wi” for winter; “sp” for spring; “fa” for fall; and the last two numbers of the year).</p> 
    <img src="images/data_1.png" alt="Data file format">
    <p>4. Save it in the "data" subfolder of the "Housing Survey Program" folder.<br><br></p>

    <h3> Making sure the data file has the right format</h3>
    <p>Every semester the file will usually look a little different. Sometimes they will add more or less columns, sometimes they will change the name of the columns, and sometimes they are going to change the phrasing of the questions. There are 28 columns that we will always need to have in order for the program to work. Not only do you have to make sure they exist, but you also need to make sure they are named properly. Here is a list of the name and content of each of those columns.</p> 
    <p>1.	Q18_0_GROUP - They choose the factors that made them want to live  there (Ammenities, Friends, Management, Price, Location, Free Summer Contract, Ward, Friends, Others).</p>
    <p>2. Q18_0_1_RANK - They rank from most to least important the factors they chose.</p>
    <p>3. Q18_0_2_RANK - They rank from most to least important the factors they chose.</p>
    <p>4. Q18_0_3_RANK - They rank from most to least important the factors they chose.</p>
    <p>5. Q18_0_4_RANK - They rank from most to least important the factors they chose.</p>
    <p>6. Q18_0_5_RANK - They rank from most to least important the factors they chose.</p>
    <p>7. Q18_0_6_RANK - They rank from most to least important the factors they chose.</p>
    <p>8. Q18_0_7_RANK - They rank from most to least important the factors they chose.</p>
    <p>9. Q18_0_8_RANK - They rank from most to least important the factors they chose.</p>
    <p>10. Q18_0_8_TEXT - They write what the "other" factors made them choose to live there.</p>
    <p>11. Q1.4 - They write what what their favorite part about living there is.</p>
    <p>12. Q1.5 - They write things that they think their complex should change or improve on.</p>
    <p>13. Q1.6_1- They rate the management in their apartment complex from 0 to 5.</p>
    <p>14. Q1.6_2- They rate the maintenance response in their apartment complex from 0 to .</p>
    <p>15. Q1.6_3- They rate the cleanliness in their apartment complex from 0 to 5.</p>
    <p>16. Q1.6_4- They rate the activities/ events in their apartment complex from 0 to 5.</p>
    <p>17. Q1.6_5- They rate the internet in their apartment complex from 0 to 5.</p>
    <p>18. Q1.6_6- They rate the culture in their apartment complex from 0 to 5.</p>
    <p>19. Q1.6_7- They rate the value(price for what they receive) in their apartment complex from 0 to 5.</p>
    <p>20. Q1.7- They write what they think management does best.</p>
    <p>21. Q1.8- They write what they think management could do better.</p>
    <p>22. Q1.9_1 - They rate their apartment complex overall from 1 to 5.</p>
    <p>23. Q1.10 - They write what they think their apartment complex could do to streghten the relationship between roommates.</p>
    <p>24. Q1.11 - They have to select between three options, about whether they are staying there, moving somewhere else, or leaving for good ("Not applicable because I am graduating, getting married, leaving school, etc.", "I plan to leave this apartment complex for another complex next semester (or my next on-track semester).", "I plan to return to this apartment complex next semester (or my next on-track semester).").</p>
    <p>25. Q1.12 - They write write why they're choosing to stay there (if they are).</p>
    <p>26. Q1.13 - They write write why they're to move somwhere else (if they are).</p>
    <p>27. Complex_Name - It doesn't matter if they're capitalized as the name matches the one in "complex_names.csv".</p>
    <p>28. Finshed - If this column doesn't exist, just add "TRUE" to each row with responses in it.</p>
    
    

  </div>
  
  <div id="vs" class="tabcontent">
      <h2>Setting up VS Code</h2>
      <p>VS Code is a Microsoft app used programmers wirte, test, and run code. We will be using it to be able to open the our python files that generate the reports. Here are instructions on how to do it:</p>
      <p>1.	Open this link https://code.visualstudio.com/download in your browser.</p>
      <p>2. Click on the Windows installation.</p>
      <img src="images/vs_code_1.png" alt="VS download">
      <p>3. Open the “VSCodeUserSetup.exe” that was downloaded by clicking on the download.</p>
      <img src="images/vs_code_2.png" alt="VS download">
      <p>4. Follow the instructions until you click “Finish”.</p>
      <p>5. Open VS Code (If you don’t see it on your desktop, you can search for it using the Windows search engine).</p>
      <img src="images/vs_code_3.png" alt="VS download">
      <p>6. Click on “File” > “Open Folder…”.</p>
      <img src="images/vs_code_4.png" alt="VS download">
      <p>7. Open the "Housing Survey Program" folder.</p>
      <p>8. Click on “Yes, I trust the authors”.</p>
      <img src="images/vs_code_5.png" alt="VS download">
  
      <h3>Installing Markdown Preview Enhanced</h3>
      <p>When the reports are generated, they are in HTML and CSS, which are the "languages" used to tell websites how they are supposed to look. Markdown Preview is an extension available in VS Code that allows us to visualize the code in the reports in as pdf. Here is how to install it.</p>
      <p>1.	Click on the Extensions tab on the left-hand side (icon looks like the Tetris blocks).</p>
      <p>2. Search Markdown Preview Enhanced.</p>
      <p>3. Install the one by Yiyi Wang.</p>
      <img src="images/vs_code_7.png" alt="VS download">
      <p>4. Go to File > Preferences > Settings (at the top of window).</p>
      <img src="images/vs_code_6.png" alt="VS download">
      <p>5. Search “print background”.</p>
      <p>6. Make sure “Markdown-preview-enhanced: Print Background” setting is CHECKED.</p>
      <img src="images/vs_code_8.png" alt="VS download">
   </div>
  
   <div id="python" class="tabcontent">
    <h2>Installing python in VS Code</h2>
    <p>1.	Click on the Extensions tab on the left-hand side (icon looks like the Tetris blocks).</p>
    <p>2. Search Python.</p>
    <p>3. Install the one by Mircrosoft.</p>
    <img src="images/python_1.png" alt="Python installation">
  
    <h3>Installing pandas</h3>
    <p>Pandas is a python "library" with features that make it easier to deal with a lot of data. Some functions in the prorgram need pandas to work. This is how you can install it:  </p>
    <p>1. Make sure you install python FIRST.</p>
    <p>2.	Click on “Terminal” and “New Terminal.</p>
    <img src="images/python_2.png" alt="Python installation">
    <p>3. Make sure a window pops up at the bottom of VS Code.</p>
    <p>4. Click on the window to start writing.</p>
    <p>5. Type "pip install pandas" in the window.</p>
    <p>6. Press enter.</p>
    <p>7. Wait for the command to run.</p>
    <p>8. Make sure that once it stops you see a line that say “Successfully installed pandas -”.</p>
    <img src="images/python_4.png" alt="Python installation">
    <p>9. Close VS Code and open it again.</p>
  </div>
  
   <div id="code" class="tabcontent">
      <h2>Updating the threshold in ratings reports</h2>
      <p>The ratings reports rank the apartments based on their ratings in different areas. The smaller apartments sometimes striggle to get enough people to fill the survey. For those cases where there is not enough reponses to get an actual rating for the complex, we set threshold on how many responses a complex needs to have in order to actually be added to the ranking table. Right now, that threshold is 20. If were ever asked to change that threshold, here is how to change it:</p>
      <p>1. Open VS code.</p>
      <p>2. Make sure the "Housing Survey Program" folder is oopen is the explorer.</p>
      <p>3. Click on "reports_functions.py".</p>
      <p>3. Press "ctrl" + "f".</p>
      <p>4. Enter "# Setting threshold for yearly vs semester" in the search bar.</p>
      <p>5. Locate it in "reports_functions.py".</p>
      <p>6. Adjust both semester and yearly thresholds to whichever number you want.</p>
      <p>7. Go to "File" on the top left corner of the window.</p>
      <p>8. Click on "Save".</p>
      <p>This is the only time you would ever need to do something with the "reports_functions" file. You don't even have to run it either. If when generating the reports, you have both python files open in your tabs, and you run this one by accident, the terminal would pop up at the bottom of the screen, but it wouldn't do anything. This file is  bascially just instructions that help "main.py" know what it supposed to do with the data.<br><br></p>
      
      <h2>Running the code</h2>
      <p></p>
      <p>1. Make sure that the "Housing Survey Program" folder is open in the VS Code explorer on the left.</p>
      <p>2. Click on "main.py".</p>
      <img id="code_img1" src="images/code_1.png" alt="folder_screenshot">
      <p>3. Find the part at the beggining that say "Variables that change every semester".</p>
      <p>4. Change the time frame for year and semester to match the one of reports you are trying to get</p>
      <p>5. Use "semester" as time_frame_type, unless you want the end of the year summary for all semesters.</p>
      <img src="images/code_2.png" alt="folder_screenshot">
      <p>6. Go to "File" at the top left corner of the window.</p>
      <p>7. Click on "Save".</p>
      <p>8. Run the code by pressing the play button on the top righ corer of the window.</p>
      <img src="images/code_3.png" alt="folder_screenshot">
      <p>9. Wait for the terminal to appear at the bottom and for the code to stop running.</p>
      <p>10. Make sure that the message "“Successfully created all reports" comes up in the terminal. You will need to see that message four times in semester reports, and twice for yearly reports.</p>
      <img src="images/code_4.png" alt="folder_screenshot">
      <img src="images/code_5.png" alt="folder_screenshot">
   </div>
  
   <div id="reports" class="tabcontent">
      <h2>Making sure the reports were actually created</h2>
      <p>After you have run the program and have seen the "Successfully..." messagges on the terminal, you now have to make sure the files are actually in their respective folders. Here is how you can do that from VS Code:</p>
      <p>1. Go to the VS Code explorer on your left.</p>
      <p>2. Make "Housing Survey Program" folder is open.</p>
      <p>3. Hover your mouse over the name of the folder.</p>
      <p>4. "Refresh Explorer" by clicking on the arrow.</p>
      <p>5. Click on "reports" and in the explorer.</p>
      <p>6. Go to the folder of the year you are in.</p>
      <p>7. Find the folder where your reports are supposed to be in.</p>
      <p>8. Make sure there are some "md" files there.<br><br></p>

      <h3>Where to find each of those reports</h3>
      <p>There are six different types of reports. Four of those are generated every semester, and the other two are generated once at the end of each year. These are the types of reports there are, and the folders they go in:</p>
      <p>1. The one "All_Complexes..." yearly report found in the main section of the year folder.</p>
      <p>2. The eight "Ratings_(Ammenities, Activities/Events, Culture, Internet, Management, Maintenance, Value, and Overall) yearly reports found in the "all_ratings" folder.</p>
      <p>3. The one "All_Complexes..." semester report found in the semester folder.</p>
      <p>4. The eight"Ratings_(Ammenities, Activities/Events, Culture, Internet, Management, Maintenance, Value, and Overall) semester reports found in the "(semester)_ratings" folder.</p>
      <p>5. The one semester report for each apartment complex surveyed found in the semester folder.</p>
      <p>6. The one semester report for each owner found in the semester folder.<br><br></p>

      <h3>Converting the reports to PDF</h3>
      <p>Once you have made sure the reports are actually where they're supossed to, you have to convert them to PDF. Here is how to do that:</p>
      <p>1. Make sure you have that the folder where they are is open in the VS Code explorer.</p>
      <p>2. Click on the md file at the top of the list of the folder.</p>
      <p>3. Make sure that after you clicked on it, it opened as a new tab next to "main.py".</p>
      <p>4. Click on the file and drag it next to it if it didn't.</p>
      <p>5. Click on the "“Markdown Peview Enhanced" icon at the top right corner of the screen (looks like a book with a magnifying glass).</p>
      <p>6. Right click on the preview window that popped up.</p>
      <p>7. Find the "Chrome Pupeteer" option (which will probably be under "Export").</p>
      <p>8. Select "PDF" to automatically convert and open the file as in that formart.</p>
      <p>9. Go to the VS Code explorer where the md file you just opened is.</p>
      <p>10. Make sure that underneath it, there is a new pdf file with its same.</p>
      <p>11. Close that new pdf preview in your browser, and then both of the markdown preview and the code tabs for that report in VS Code.</p>
      <p>12. Follow same process for each md file you need to convert.</p>

      <h3>What do with the PDFs</h3>
      <p>1. Make sure they have all been converted by checking if there is a PDF under each of your md files.</p>
      <p>2. Find one of each of the diiferent types of reports you need. </p>
      <p>3. Go through them to make sure there are no major issues with them.</p>
      <p>4. Compare them to a report from the past to make sure the formatting is right.</p>
      <p>5. Let Brother Dougherty know that you have created and gone all of the reports.</p>
      <p>6. Show him the folder where they are located in the idrive.</p>
      <p>7. Ask him if he would like you to move a COPY of all the reports (in PDF format) to a different folder.</p>
      <p>8. Do it if you need to, and if not you're DONE!</p>
      <p>9. Celebrate!</p>

   </div>
  
   <div id="errors" class="tabcontent">
      <h2>Errors</h2>
      <p>Errors are bad.</p>
   </div>

</div>

 
<script>
function openCity(evt, cityName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(cityName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>

<script>
  // Function to open the default tab on page load
  function openDefaultTab() {
    var defaultTab = document.getElementById("drive"); // ID of the default tab
    var defaultButton = document.querySelector(".tab button:first-child"); // First button
    defaultTab.style.display = "block";
    defaultButton.classList.add("active");
  }
  
  // Call the function when the page is loaded
  window.onload = openDefaultTab;
  </script>
   
</body>
</html> 

